# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∞–ø–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
_Exported on 13.10.2025 at 16:23:25 GMT+3 from Cursor (1.7.44)_

---

**User**

(20251013-160723)
(0) –û–∑–Ω–∞–∫–æ–º—å—Å—è —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏–∑—É—á–∏ `README.md` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞, –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ —Å—Å—ã–ª–∫–∞–º.
–î–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –∏–∑–º–µ–Ω–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–ø–∞.

(1) –§–∞–±—É–ª–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–∞—Å—Ç–æ –∑–∞–∂–∏–º–∞–µ—Ç –ø–µ—Ä–≤—É—é –∫–ª–∞–≤–∏—à—É –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, –∞ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–∂–∏–º–∞–µ—Ç –±—ã—Å—Ç—Ä–æ (–∫–æ–≥–¥–∞ –∏—Ö –Ω–∞–π–¥—ë—Ç ‚Äì –∫–ª–∞–≤–∏—à–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–æ —Ä–∞–∑–Ω–µ—Å–µ–Ω—ã –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ). –ù–∞ —ç—Ç–æ —É—Ö–æ–¥–∏—Ç –≤—Ä–µ–º—è, –∏ —Ç–∞–ø –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º.

(2) –î–∞–≤–∞–π —É—á—Ç—ë–º —ç—Ç–æ –∏, –µ—Å–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –Ω–µ —É–¥–∞–ª–æ—Å—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–µ, –º—ã –µ—ë –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø–æ–º–Ω–∏—Ç—å, –Ω–æ –≤—Ä–µ–º—è —Ç–∞–ø–∞ –æ–Ω–∞—á–∏–Ω–∞–µ–º —Å—á–∏–∞—Ç—å —Å –º–æ–º–µ–Ω—Ç–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –≤—Ç–æ—Ä—É—é –∫–ª–∞–≤–∏—à—É –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.

(3) –ü–æ–≤–µ–¥–µ–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–Ω–æ–µ –≤ (2) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: –Ω—É–∂–Ω–æ –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å: —Å—á–∏—Ç–∞—Ç—å –ª–∏ —Ç–∞–ø –ø–æ –¥–∞–Ω–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏, –∏–ª–∏ —Å–æ –≤—Ç–æ—Ä–æ–π.

‚Äî
–ü—Ä–µ–¥–ª–æ–∂–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ö–æ–¥ –ø–∏—Å–∞—Ç—å –ø–æ–∫–∞ –Ω–µ–Ω—É–∂–Ω–æ.

---

**Cursor**

–ò–∑—É—á—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, —á—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

–ò–∑—É—á—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

–û—Ç–ª–∏—á–Ω–æ, –∏–∑—É—á–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é. –ü—Ä–µ–¥–ª–æ–∂—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∞–ø–∞.

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ì–∏–±–∫–∏–π —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞ —Ç–∞–ø–∞

### **–°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã**

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
```
–ù–∞–∂–∞—Ç–∞ Ctrl_L (t=0.00s) ‚Üí start_time = 0.00s
–ù–∞–∂–∞—Ç–∞ Shift_L (t=0.15s)
–û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s) ‚Üí duration = 0.25s > timeout(0.2s) ‚ùå INVALID
```

**–ñ–µ–ª–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π):**
```
–ù–∞–∂–∞—Ç–∞ Ctrl_L (t=0.00s) ‚Üí –∂–¥—ë–º...
–ù–∞–∂–∞—Ç–∞ Shift_L (t=0.15s) ‚Üí start_time = 0.15s (!)
–û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s) ‚Üí duration = 0.10s < timeout(0.2s) ‚úÖ VALID
```

---

### **1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

**–§–∞–π–ª: `src/tap_launcher/models.py`**

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –≤ `HotkeyConfig`:

```python
@dataclass
class HotkeyConfig:
    keys: list[str]
    command: str
    args: list[str] = field(default_factory=list)
    description: str = ''
    
    # üÜï –ù–û–í–û–ï –°–í–û–ô–°–¢–í–û
    start_timer_from_second_key: bool = False
    """
    –ï—Å–ª–∏ True, —Ç–∞–π–º–µ—Ä —Ç–∞–ø–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –Ω–∞–∂–∞—Ç–∏—è –í–¢–û–†–û–ô –∫–ª–∞–≤–∏—à–∏.
    –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –≥–¥–µ –ø–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∂–∞—Ç–∞ –∑–∞—Ä–∞–Ω–µ–µ.
    
    –ü—Ä–∏–º–µ—Ä—ã:
    - False (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Ç–∞–π–º–µ—Ä —Å –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏
    - True: —Ç–∞–π–º–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
    """
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```toml
# –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä—ã–µ —Ç–∞–ø—ã)
[[hotkeys]]
keys = ["ctrl_l", "alt_l", "t"]
command = "gnome-terminal"
start_timer_from_second_key = false  # –∏–ª–∏ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å (default)

# –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –∑–∞–∂–∞—Ç—å Ctrl_L, –ø–æ—Ç–æ–º –∏—Å–∫–∞—Ç—å Shift_L)
[[hotkeys]]
keys = ["ctrl_l", "shift_l"]
command = "setxkbmap"
args = ["us"]
start_timer_from_second_key = true  # —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
```

---

### **2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ HotkeyMatcher**

**–§–∞–π–ª: `src/tap_launcher/hotkey_matcher.py`**

–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ "—á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è":

```python
class HotkeyMatcher:
    def __init__(self, hotkeys: list[HotkeyConfig]) -> None:
        self._hotkey_map: dict[frozenset[str], HotkeyConfig] = {
            hk.keys_set(): hk for hk in hotkeys
        }
        
        # üÜï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
        # –ú–∞–ø–∞: –ø–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞ ‚Üí —Å–ø–∏—Å–æ–∫ hotkeys —Å start_timer_from_second_key=True
        self._delayed_start_map: dict[str, list[HotkeyConfig]] = {}
        for hk in hotkeys:
            if hk.start_timer_from_second_key and len(hk.keys) >= 2:
                # –î–ª—è –∫–∞–∂–¥–æ–π –∫–ª–∞–≤–∏—à–∏ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                for key in hk.keys:
                    if key not in self._delayed_start_map:
                        self._delayed_start_map[key] = []
                    self._delayed_start_map[key].append(hk)
    
    def match(self, detected_keys: set[Any]) -> HotkeyConfig | None:
        """–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π."""
        ...
    
    # üÜï –ù–û–í–´–ô –ú–ï–¢–û–î
    def should_delay_timer_start(
        self, 
        first_key_normalized: str
    ) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞.
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏:
        - –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å start_timer_from_second_key=True
        - –≠—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å first_key_normalized
        
        Args:
            first_key_normalized: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–≤–æ–π –Ω–∞–∂–∞—Ç–æ–π –∫–ª–∞–≤–∏—à–∏
            
        Returns:
            bool: True –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞
        """
        return first_key_normalized in self._delayed_start_map
```

---

### **3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ TapMonitor**

**–§–∞–π–ª: `src/tap_detector/tap_monitor.py`**

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:

```python
@dataclass
class TapState:
    pressed_keys: set = field(default_factory=set)
    tap_combination: set = field(default_factory=set)
    start_time: float | None = None
    is_active: bool = False
    
    # üÜï –ù–û–í–û–ï –ü–û–õ–ï
    timer_delayed: bool = False
    """True –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä –æ—Ç–ª–æ–∂–µ–Ω –¥–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏."""

class TapMonitor:
    def __init__(
        self,
        timeout: float,
        verbose: bool = False,
        on_tap_detected: Callable | None = None,
        on_tap_invalid: Callable | None = None,
        # üÜï –ù–û–í–´–ô –ü–ê–†–ê–ú–ï–¢–†
        check_timer_delay: Callable[[str], bool] | None = None,
    ):
        """
        Args:
            ...—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...
            check_timer_delay: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å
                             —Ç–∞–π–º–µ—Ä –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏—à–∏.
                             –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: normalized_key_name (str)
                             –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: bool (True = –æ—Ç–ª–æ–∂–∏—Ç—å —Å—Ç–∞—Ä—Ç)
        """
        self.timeout = timeout
        self.verbose = verbose
        self.state = TapState()
        self.on_tap_detected = on_tap_detected
        self.on_tap_invalid = on_tap_invalid
        self.check_timer_delay = check_timer_delay
    
    def _on_press(self, key):
        # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä
        if key in self.state.pressed_keys:
            return
        
        # –ü–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞?
        if not self.state.is_active:
            normalized_key = normalize_key(key)
            
            # üÜï –ü–†–û–í–ï–†–ö–ê –ù–ê –û–¢–õ–û–ñ–ï–ù–ù–´–ô –°–¢–ê–†–¢
            if self.check_timer_delay and self.check_timer_delay(normalized_key):
                # –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞
                self.state.is_active = True
                self.state.timer_delayed = True
                self.state.start_time = None  # –ø–æ–∫–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                
                if self.verbose:
                    print(f"[TRACE] First key {normalized_key}, timer delayed")
            else:
                # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ - —Å—Ç–∞—Ä—Ç—É–µ–º —Ç–∞–π–º–µ—Ä —Å—Ä–∞–∑—É
                self.state.start_time = perf_counter()
                self.state.is_active = True
                
                if self.verbose:
                    print(f"[TRACE] Tap started with {normalized_key}")
        
        # –í—Ç–æ—Ä–∞—è (–∏–ª–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è) –∫–ª–∞–≤–∏—à–∞?
        else:
            # üÜï –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä –±—ã–ª –æ—Ç–ª–æ–∂–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –µ–≥–æ –°–ï–ô–ß–ê–°
            if self.state.timer_delayed and self.state.start_time is None:
                self.state.start_time = perf_counter()
                self.state.timer_delayed = False
                
                if self.verbose:
                    normalized_key = normalize_key(key)
                    print(f"[TRACE] Second key {normalized_key}, timer started NOW")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞–≤–∏—à—É
        self.state.pressed_keys.add(key)
        self.state.tap_combination.add(key)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ timeout (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω)
        if self.state.start_time:
            elapsed = perf_counter() - self.state.start_time
            if elapsed > self.timeout:
                if self.verbose:
                    print(f"[TRACE] Timeout exceeded: {elapsed:.3f}s")
    
    def _on_release(self, key):
        """–õ–æ–≥–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ø—Ä–æ–≤–µ—Ä—è–µ–º duration –∫–∞–∫ –æ–±—ã—á–Ω–æ."""
        if key in self.state.pressed_keys:
            self.state.pressed_keys.remove(key)
        
        # –í—Å–µ –∫–ª–∞–≤–∏—à–∏ –æ—Ç–ø—É—â–µ–Ω—ã?
        if not self.state.pressed_keys and self.state.is_active:
            # üÜï –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä —Ç–∞–∫ –∏ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω (—Ç–æ–ª—å–∫–æ 1 –∫–ª–∞–≤–∏—à–∞ –Ω–∞–∂–∞—Ç–∞)
            if self.state.start_time is None:
                # –≠—Ç–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 2 –∫–ª–∞–≤–∏—à–∏
                if self.verbose:
                    print("[DEBUG] Tap invalid: only one key pressed")
                if self.on_tap_invalid:
                    self.on_tap_invalid(
                        "insufficient keys", 
                        self.state.tap_combination.copy(), 
                        0.0
                    )
                self.state.reset()
                return
            
            # –û–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
            end_time = perf_counter()
            duration = end_time - self.state.start_time
            
            is_valid = duration <= self.timeout
            
            if is_valid:
                if self.on_tap_detected:
                    self.on_tap_detected(
                        self.state.tap_combination.copy(), 
                        duration
                    )
            else:
                if self.on_tap_invalid:
                    self.on_tap_invalid(
                        "timeout exceeded", 
                        self.state.tap_combination.copy(), 
                        duration
                    )
            
            self.state.reset()
```

---

### **4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ LauncherMonitor**

**–§–∞–π–ª: `src/tap_launcher/launcher_monitor.py`**

–ü–µ—Ä–µ–¥–∞—Ç—å callback –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:

```python
class LauncherMonitor:
    def __init__(
        self,
        config: AppConfig,
        matcher: HotkeyMatcher,
        executor: CommandExecutor,
    ) -> None:
        self.config = config
        self.matcher = matcher
        self.executor = executor
        self.logger = logging.getLogger('tap_launcher.monitor')
        
        # üÜï –°–æ–∑–¥–∞—ë–º TapMonitor —Å callback –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
        self.tap_monitor = TapMonitor(
            timeout=config.tap_timeout,
            verbose=config.verbose_logging,
            on_tap_detected=self._on_tap_detected,
            on_tap_invalid=None,
            # üÜï –ù–û–í–´–ô –ü–ê–†–ê–ú–ï–¢–†
            check_timer_delay=self._check_timer_delay,
        )
    
    # üÜï –ù–û–í–´–ô –ú–ï–¢–û–î
    def _check_timer_delay(self, first_key_normalized: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏—à–∏.
        
        –≠—Ç–æ—Ç callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è TapMonitor –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏.
        
        Args:
            first_key_normalized: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏
            
        Returns:
            bool: True –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º —Å—Ç–∞—Ä—Ç–æ–º
        """
        return self.matcher.should_delay_timer_start(first_key_normalized)
```

---

### **5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

**–§–∞–π–ª: `config/tap-launcher.toml.example`**

```toml
# –ü—Ä–∏–º–µ—Ä 1: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä—ã–π —Ç–∞–ø)
[[hotkeys]]
keys = ["ctrl_l", "alt_l", "t"]
command = "gnome-terminal"
args = []
description = "Open terminal"
# start_timer_from_second_key –Ω–µ —É–∫–∞–∑–∞–Ω = false (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

# –ü—Ä–∏–º–µ—Ä 2: –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (–º–æ–∂–Ω–æ –∑–∞–∂–∞—Ç—å –ø–µ—Ä–≤—É—é –∫–ª–∞–≤–∏—à—É)
[[hotkeys]]
keys = ["ctrl_l", "shift_l"]
command = "setxkbmap"
args = ["us"]
description = "Switch to English layout"
start_timer_from_second_key = true  # üÜï —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏

[[hotkeys]]
keys = ["ctrl_r", "shift_r"]
command = "setxkbmap"
args = ["ru"]
description = "Switch to Russian layout"
start_timer_from_second_key = true  # üÜï —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
```

---

### **6. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ ConfigLoader**

**–§–∞–π–ª: `src/tap_launcher/config_loader.py`**

–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è:

```python
@staticmethod
def _parse_hotkey(hotkey_data: dict) -> HotkeyConfig:
    """Parse a single hotkey from config data."""
    return HotkeyConfig(
        keys=hotkey_data['keys'],
        command=hotkey_data['command'],
        args=hotkey_data.get('args', []),
        description=hotkey_data.get('description', ''),
        # üÜï –ù–û–í–û–ï –ü–û–õ–ï
        start_timer_from_second_key=hotkey_data.get(
            'start_timer_from_second_key', 
            False
        ),
    )
```

---

## **–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (`start_timer_from_second_key=false`)**

```
–ö–æ–Ω—Ñ–∏–≥: keys=["ctrl_l", "alt_l", "t"], start_timer_from_second_key=false

1. –ù–∞–∂–∞—Ç–∞ ctrl_l (t=0.00s)
   ‚Üí check_timer_delay("ctrl_l") ‚Üí False
   ‚Üí start_time = 0.00s, timer_delayed = False

2. –ù–∞–∂–∞—Ç–∞ alt_l (t=0.05s)
   ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≤ combination

3. –ù–∞–∂–∞—Ç–∞ t (t=0.10s)
   ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≤ combination

4. –û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.15s)
   ‚Üí duration = 0.15s - 0.00s = 0.15s < 0.2s ‚úÖ VALID
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (`start_timer_from_second_key=true`)**

```
–ö–æ–Ω—Ñ–∏–≥: keys=["ctrl_l", "shift_l"], start_timer_from_second_key=true

1. –ù–∞–∂–∞—Ç–∞ ctrl_l (t=0.00s)
   ‚Üí check_timer_delay("ctrl_l") ‚Üí True
   ‚Üí start_time = None, timer_delayed = True, is_active = True

2. –ù–∞–∂–∞—Ç–∞ shift_l (t=0.15s)  # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–∫–∞–ª –∫–ª–∞–≤–∏—à—É!
   ‚Üí timer_delayed=True –∏ start_time=None
   ‚Üí start_time = 0.15s, timer_delayed = False

3. –û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s)
   ‚Üí duration = 0.25s - 0.15s = 0.10s < 0.2s ‚úÖ VALID
```

---

## **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è**

‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ `start_timer_from_second_key` —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ

‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –ö–∞–∂–¥–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ

‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –±—ã—Å—Ç—Ä—ã–π lookup –≤ `_delayed_start_map`

‚úÖ **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å**: –ü–æ–≤–µ–¥–µ–Ω–∏–µ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## **Edge cases**

**Q: –ß—Ç–æ –µ—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∫–ª–∞–≤–∏—à–∞ —Å `start_timer_from_second_key=true`?**  
A: –¢–∞–ø –±—É–¥–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–µ–Ω ("insufficient keys"), —Ç–∞–∫ –∫–∞–∫ —Ç–∞–π–º–µ—Ä –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è.

**Q: –ß—Ç–æ –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –æ–¥–Ω–æ–π –∫–ª–∞–≤–∏—à–∏, –Ω–æ —É –Ω–∏—Ö —Ä–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?**  
A: `check_timer_delay` –≤–µ—Ä–Ω—ë—Ç `True`, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∏–º–µ–µ—Ç `start_timer_from_second_key=true`. –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.

**Q: –í–ª–∏—è–µ—Ç –ª–∏ —ç—Ç–æ –Ω–∞ `tap-detector`?**  
A: –ù–µ—Ç, `tap-detector` –Ω–µ –∑–Ω–∞–µ—Ç –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ. –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ `tap-launcher`.

---

–≠—Ç–æ –ø–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ì–æ—Ç–æ–≤ –æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∏–ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è! üöÄ

```plaintext
–ù–∞–∂–∞—Ç–∞ Ctrl_L (t=0.00s) ‚Üí start_time = 0.00s
–ù–∞–∂–∞—Ç–∞ Shift_L (t=0.15s)
–û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s) ‚Üí duration = 0.25s > timeout(0.2s) ‚ùå INVALID
```

```plaintext
–ù–∞–∂–∞—Ç–∞ Ctrl_L (t=0.00s) ‚Üí –∂–¥—ë–º...
–ù–∞–∂–∞—Ç–∞ Shift_L (t=0.15s) ‚Üí start_time = 0.15s (!)
–û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s) ‚Üí duration = 0.10s < timeout(0.2s) ‚úÖ VALID
```

```python
@dataclass
class HotkeyConfig:
    keys: list[str]
    command: str
    args: list[str] = field(default_factory=list)
    description: str = ''
    
    # üÜï –ù–û–í–û–ï –°–í–û–ô–°–¢–í–û
    start_timer_from_second_key: bool = False
    """
    –ï—Å–ª–∏ True, —Ç–∞–π–º–µ—Ä —Ç–∞–ø–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –Ω–∞–∂–∞—Ç–∏—è –í–¢–û–†–û–ô –∫–ª–∞–≤–∏—à–∏.
    –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –≥–¥–µ –ø–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∂–∞—Ç–∞ –∑–∞—Ä–∞–Ω–µ–µ.
    
    –ü—Ä–∏–º–µ—Ä—ã:
    - False (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Ç–∞–π–º–µ—Ä —Å –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏
    - True: —Ç–∞–π–º–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
    """
```

```toml
# –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä—ã–µ —Ç–∞–ø—ã)
[[hotkeys]]
keys = ["ctrl_l", "alt_l", "t"]
command = "gnome-terminal"
start_timer_from_second_key = false  # –∏–ª–∏ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å (default)

# –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –∑–∞–∂–∞—Ç—å Ctrl_L, –ø–æ—Ç–æ–º –∏—Å–∫–∞—Ç—å Shift_L)
[[hotkeys]]
keys = ["ctrl_l", "shift_l"]
command = "setxkbmap"
args = ["us"]
start_timer_from_second_key = true  # —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
```

```python
class HotkeyMatcher:
    def __init__(self, hotkeys: list[HotkeyConfig]) -> None:
        self._hotkey_map: dict[frozenset[str], HotkeyConfig] = {
            hk.keys_set(): hk for hk in hotkeys
        }
        
        # üÜï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
        # –ú–∞–ø–∞: –ø–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞ ‚Üí —Å–ø–∏—Å–æ–∫ hotkeys —Å start_timer_from_second_key=True
        self._delayed_start_map: dict[str, list[HotkeyConfig]] = {}
        for hk in hotkeys:
            if hk.start_timer_from_second_key and len(hk.keys) >= 2:
                # –î–ª—è –∫–∞–∂–¥–æ–π –∫–ª–∞–≤–∏—à–∏ –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
                for key in hk.keys:
                    if key not in self._delayed_start_map:
                        self._delayed_start_map[key] = []
                    self._delayed_start_map[key].append(hk)
    
    def match(self, detected_keys: set[Any]) -> HotkeyConfig | None:
        """–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π."""
        ...
    
    # üÜï –ù–û–í–´–ô –ú–ï–¢–û–î
    def should_delay_timer_start(
        self, 
        first_key_normalized: str
    ) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞.
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏:
        - –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å start_timer_from_second_key=True
        - –≠—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å first_key_normalized
        
        Args:
            first_key_normalized: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–≤–æ–π –Ω–∞–∂–∞—Ç–æ–π –∫–ª–∞–≤–∏—à–∏
            
        Returns:
            bool: True –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞
        """
        return first_key_normalized in self._delayed_start_map
```

```python
@dataclass
class TapState:
    pressed_keys: set = field(default_factory=set)
    tap_combination: set = field(default_factory=set)
    start_time: float | None = None
    is_active: bool = False
    
    # üÜï –ù–û–í–û–ï –ü–û–õ–ï
    timer_delayed: bool = False
    """True –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä –æ—Ç–ª–æ–∂–µ–Ω –¥–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏."""

class TapMonitor:
    def __init__(
        self,
        timeout: float,
        verbose: bool = False,
        on_tap_detected: Callable | None = None,
        on_tap_invalid: Callable | None = None,
        # üÜï –ù–û–í–´–ô –ü–ê–†–ê–ú–ï–¢–†
        check_timer_delay: Callable[[str], bool] | None = None,
    ):
        """
        Args:
            ...—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...
            check_timer_delay: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å
                             —Ç–∞–π–º–µ—Ä –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏—à–∏.
                             –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: normalized_key_name (str)
                             –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: bool (True = –æ—Ç–ª–æ–∂–∏—Ç—å —Å—Ç–∞—Ä—Ç)
        """
        self.timeout = timeout
        self.verbose = verbose
        self.state = TapState()
        self.on_tap_detected = on_tap_detected
        self.on_tap_invalid = on_tap_invalid
        self.check_timer_delay = check_timer_delay
    
    def _on_press(self, key):
        # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä
        if key in self.state.pressed_keys:
            return
        
        # –ü–µ—Ä–≤–∞—è –∫–ª–∞–≤–∏—à–∞?
        if not self.state.is_active:
            normalized_key = normalize_key(key)
            
            # üÜï –ü–†–û–í–ï–†–ö–ê –ù–ê –û–¢–õ–û–ñ–ï–ù–ù–´–ô –°–¢–ê–†–¢
            if self.check_timer_delay and self.check_timer_delay(normalized_key):
                # –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞
                self.state.is_active = True
                self.state.timer_delayed = True
                self.state.start_time = None  # –ø–æ–∫–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                
                if self.verbose:
                    print(f"[TRACE] First key {normalized_key}, timer delayed")
            else:
                # –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ - —Å—Ç–∞—Ä—Ç—É–µ–º —Ç–∞–π–º–µ—Ä —Å—Ä–∞–∑—É
                self.state.start_time = perf_counter()
                self.state.is_active = True
                
                if self.verbose:
                    print(f"[TRACE] Tap started with {normalized_key}")
        
        # –í—Ç–æ—Ä–∞—è (–∏–ª–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è) –∫–ª–∞–≤–∏—à–∞?
        else:
            # üÜï –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä –±—ã–ª –æ—Ç–ª–æ–∂–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –µ–≥–æ –°–ï–ô–ß–ê–°
            if self.state.timer_delayed and self.state.start_time is None:
                self.state.start_time = perf_counter()
                self.state.timer_delayed = False
                
                if self.verbose:
                    normalized_key = normalize_key(key)
                    print(f"[TRACE] Second key {normalized_key}, timer started NOW")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞–≤–∏—à—É
        self.state.pressed_keys.add(key)
        self.state.tap_combination.add(key)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ timeout (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω)
        if self.state.start_time:
            elapsed = perf_counter() - self.state.start_time
            if elapsed > self.timeout:
                if self.verbose:
                    print(f"[TRACE] Timeout exceeded: {elapsed:.3f}s")
    
    def _on_release(self, key):
        """–õ–æ–≥–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ø—Ä–æ–≤–µ—Ä—è–µ–º duration –∫–∞–∫ –æ–±—ã—á–Ω–æ."""
        if key in self.state.pressed_keys:
            self.state.pressed_keys.remove(key)
        
        # –í—Å–µ –∫–ª–∞–≤–∏—à–∏ –æ—Ç–ø—É—â–µ–Ω—ã?
        if not self.state.pressed_keys and self.state.is_active:
            # üÜï –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä —Ç–∞–∫ –∏ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω (—Ç–æ–ª—å–∫–æ 1 –∫–ª–∞–≤–∏—à–∞ –Ω–∞–∂–∞—Ç–∞)
            if self.state.start_time is None:
                # –≠—Ç–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 2 –∫–ª–∞–≤–∏—à–∏
                if self.verbose:
                    print("[DEBUG] Tap invalid: only one key pressed")
                if self.on_tap_invalid:
                    self.on_tap_invalid(
                        "insufficient keys", 
                        self.state.tap_combination.copy(), 
                        0.0
                    )
                self.state.reset()
                return
            
            # –û–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
            end_time = perf_counter()
            duration = end_time - self.state.start_time
            
            is_valid = duration <= self.timeout
            
            if is_valid:
                if self.on_tap_detected:
                    self.on_tap_detected(
                        self.state.tap_combination.copy(), 
                        duration
                    )
            else:
                if self.on_tap_invalid:
                    self.on_tap_invalid(
                        "timeout exceeded", 
                        self.state.tap_combination.copy(), 
                        duration
                    )
            
            self.state.reset()
```

```python
class LauncherMonitor:
    def __init__(
        self,
        config: AppConfig,
        matcher: HotkeyMatcher,
        executor: CommandExecutor,
    ) -> None:
        self.config = config
        self.matcher = matcher
        self.executor = executor
        self.logger = logging.getLogger('tap_launcher.monitor')
        
        # üÜï –°–æ–∑–¥–∞—ë–º TapMonitor —Å callback –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
        self.tap_monitor = TapMonitor(
            timeout=config.tap_timeout,
            verbose=config.verbose_logging,
            on_tap_detected=self._on_tap_detected,
            on_tap_invalid=None,
            # üÜï –ù–û–í–´–ô –ü–ê–†–ê–ú–ï–¢–†
            check_timer_delay=self._check_timer_delay,
        )
    
    # üÜï –ù–û–í–´–ô –ú–ï–¢–û–î
    def _check_timer_delay(self, first_key_normalized: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏—à–∏.
        
        –≠—Ç–æ—Ç callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è TapMonitor –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏.
        
        Args:
            first_key_normalized: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø–µ—Ä–≤–æ–π –∫–ª–∞–≤–∏—à–∏
            
        Returns:
            bool: True –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º —Å—Ç–∞—Ä—Ç–æ–º
        """
        return self.matcher.should_delay_timer_start(first_key_normalized)
```

```toml
# –ü—Ä–∏–º–µ—Ä 1: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä—ã–π —Ç–∞–ø)
[[hotkeys]]
keys = ["ctrl_l", "alt_l", "t"]
command = "gnome-terminal"
args = []
description = "Open terminal"
# start_timer_from_second_key –Ω–µ —É–∫–∞–∑–∞–Ω = false (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

# –ü—Ä–∏–º–µ—Ä 2: –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (–º–æ–∂–Ω–æ –∑–∞–∂–∞—Ç—å –ø–µ—Ä–≤—É—é –∫–ª–∞–≤–∏—à—É)
[[hotkeys]]
keys = ["ctrl_l", "shift_l"]
command = "setxkbmap"
args = ["us"]
description = "Switch to English layout"
start_timer_from_second_key = true  # üÜï —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏

[[hotkeys]]
keys = ["ctrl_r", "shift_r"]
command = "setxkbmap"
args = ["ru"]
description = "Switch to Russian layout"
start_timer_from_second_key = true  # üÜï —Ç–∞–π–º–µ—Ä —Å–æ –≤—Ç–æ—Ä–æ–π –∫–ª–∞–≤–∏—à–∏
```

```python
@staticmethod
def _parse_hotkey(hotkey_data: dict) -> HotkeyConfig:
    """Parse a single hotkey from config data."""
    return HotkeyConfig(
        keys=hotkey_data['keys'],
        command=hotkey_data['command'],
        args=hotkey_data.get('args', []),
        description=hotkey_data.get('description', ''),
        # üÜï –ù–û–í–û–ï –ü–û–õ–ï
        start_timer_from_second_key=hotkey_data.get(
            'start_timer_from_second_key', 
            False
        ),
    )
```

```plaintext
–ö–æ–Ω—Ñ–∏–≥: keys=["ctrl_l", "alt_l", "t"], start_timer_from_second_key=false

1. –ù–∞–∂–∞—Ç–∞ ctrl_l (t=0.00s)
   ‚Üí check_timer_delay("ctrl_l") ‚Üí False
   ‚Üí start_time = 0.00s, timer_delayed = False

2. –ù–∞–∂–∞—Ç–∞ alt_l (t=0.05s)
   ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≤ combination

3. –ù–∞–∂–∞—Ç–∞ t (t=0.10s)
   ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≤ combination

4. –û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.15s)
   ‚Üí duration = 0.15s - 0.00s = 0.15s < 0.2s ‚úÖ VALID
```

```plaintext
–ö–æ–Ω—Ñ–∏–≥: keys=["ctrl_l", "shift_l"], start_timer_from_second_key=true

1. –ù–∞–∂–∞—Ç–∞ ctrl_l (t=0.00s)
   ‚Üí check_timer_delay("ctrl_l") ‚Üí True
   ‚Üí start_time = None, timer_delayed = True, is_active = True

2. –ù–∞–∂–∞—Ç–∞ shift_l (t=0.15s)  # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–∫–∞–ª –∫–ª–∞–≤–∏—à—É!
   ‚Üí timer_delayed=True –∏ start_time=None
   ‚Üí start_time = 0.15s, timer_delayed = False

3. –û—Ç–ø—É—â–µ–Ω—ã –≤—Å–µ (t=0.25s)
   ‚Üí duration = 0.25s - 0.15s = 0.10s < 0.2s ‚úÖ VALID
```

